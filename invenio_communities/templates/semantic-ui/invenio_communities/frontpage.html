{# -*- coding: utf-8 -*-

  This file is part of Invenio.
  Copyright (C) 2016-2020 CERN.
  Copyright (C) 2023 Northwestern University.

  Invenio is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}

{% extends "invenio_communities/base.html" %}

{%- set title = _(community_type.get_plural_capitalized()) -%}

{%- block javascript %}
  {{ super() }}
  {{ webpack['invenio-communities-frontpage.js'] }}
{%- endblock %}

{%- block page_body %}
<div class="ui container fluid page-subheader-outer ml-0-mobile mr-0-mobile">
  <div class="ui container centered grid page-subheader rel-pt-1">
    <div class="centered one column row">
      <h1 class="ui header">
        {{_(community_type.get_plural_capitalized())}}
      </h1>
    </div>
    <div class="one column row">
      <div class="thirteen wide mobile ten wide tablet eight wide computer center aligned column">
        <p>
          {{_('Organize, curate and collaborate on records for your institution, project, topic or event.')}}
        </p>
      </div>
    </div>
    <div class="two column stackable row">
      <div class="eight wide tablet five wide computer column mt-auto mb-auto">
        <form action="{{ url_for('invenio_communities.'+community_type.get_plural()+'_search') }}" class="ui form">
          <div class="ui fluid action input">
            <input
              aria-label="{{ _('Search '+community_type.get_plural()) }}"
              class="form-control"
              name="q"
              placeholder="{{ _('Search '+community_type.get_plural()) }}"
              type="text"
            >
            <button
              aria-label="{{ _('Search') }}"
              class="ui icon search button"
              type="submit"
            >
              <i aria-hidden="true" class="search icon"></i>
            </button>
          </div>
        </form>
      </div>
      {% if permissions.can_create %}
        <div class="three wide mobile five wide tablet three wide computer stretched column">
          <a class="ui icon left labeled positive button" href="{{ config.COMMUNITIES_ROUTES['new'+community_type.get_plural_with_prefix_or_empty(prefix='_')] }}" role="button">
            <i class="icon plus"></i>
            {{_('New '+community_type.get_singular())}}
          </a>
        </div>
      {% endif %}
    </div>
    <div class="ui divider hidden"></div>
  </div>
</div>
<div class="ui container communities-frontpage grid">
  {% if current_user.is_authenticated %}
    <div class="flex row">
      <div class="flex column" style="width:33%">
        <div class="flex">
          <h3 class="ui header mb-0 align-self-center">{{_('My communities')}}</h3>
          <a class="align-self-center rel-ml-1 " href="{{url_for('invenio_app_rdm_users.communities')}}">
            {{ _('See all')}}
          </a>
        </div>
        <div class="ui divider hidden"></div>
        <div
          class="rel-mb-2"
          data-community-type='{{ "community" | tojson }}'
          id="user-communities"
        ></div>
      </div>
      {% if config.COMMUNITIES_SHOW_SPECIFIC_TYPES %}
      <div class="flex column" style="width:33%">
        <div class="flex">
          <h3 class="ui header mb-0 align-self-center">{{_('My organizations')}}</h3>
          <a class="align-self-center rel-ml-1 " href="{{url_for('invenio_app_rdm_users.organizations')}}">
            {{ _('See all')}}
          </a>
        </div>
        <div class="ui divider hidden"></div>
        <div
          class="rel-mb-2"
          data-community-type='{{ "organization" | tojson }}'
          id="user-organizations"
        ></div>
      </div>
      <div class="flex column" style="width:33%">
        <div class="flex">
          <h3 class="ui header mb-0 align-self-center">{{_('My persons')}}</h3>
          <a class="align-self-center rel-ml-1 " href="{{url_for('invenio_app_rdm_users.persons')}}">
            {{ _('See all')}}
          </a>
        </div>
        <div class="ui divider hidden"></div>
        <div
          class="rel-mb-2"
          data-community-type='{{ "person" | tojson }}'
          id="user-persons"
        ></div>
      </div>
      {% endif %}
    </div>
    <div class="ui divider"></div>
  {% endif %}
  <div class="flex row">
    <div class="flex column" style="width:33%">
      <div class="flex row">
        <h3 class="ui header mb-0 align-self-center">{{ _('New communities') }}</h3>
        <a class="align-self-center rel-ml-1" href="{{url_for('invenio_communities.communities_search')}}">
            {{ _('See all')}}
          </a>
      </div>
      <div class="ui divider hidden"></div>
      <div
        data-community-type='{{ "community" | tojson }}'
          id="new-communities"
      ></div>
    </div>
      {% if config.COMMUNITIES_SHOW_SPECIFIC_TYPES %}
    <div class="flex column" style="width:33%">
      <div class="flex row">
        <h3 class="ui header mb-0 align-self-center">{{ _('New organizations') }}</h3>
        <a class="align-self-center rel-ml-1" href="{{url_for('invenio_communities.organizations_search')}}">
            {{ _('See all')}}
          </a>
      </div>
      <div class="ui divider hidden"></div>
      <div
        data-community-type='{{ "organization" | tojson }}'
        id="new-organizations"
      ></div>
    </div>
    <div class="flex column" style="width:33%">
      <div class="flex row">
        <h3 class="ui header mb-0 align-self-center">{{ _('New persons') }}</h3>
        <a class="align-self-center rel-ml-1" href="{{url_for('invenio_communities.persons_search')}}">
            {{ _('See all')}}
          </a>
      </div>
      <div class="ui divider hidden"></div>
      <div
        data-community-type='{{ "person" | tojson }}'
        id="new-persons"
      ></div>
    </div>
    {% endif %}
  </div>
</div>
{%- endblock page_body %}
